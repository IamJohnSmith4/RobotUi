<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>UDRU Robot Kiosk</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --udru-blue: #004a99;
            --udru-gold: #ffcc00;
        }

        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            /* ป้องกันการคลุมดำเลือกข้อความเพื่อให้ดูเป็นแอปหุ่นยนต์ */
            -webkit-user-select: none;
            user-select: none;
        }

        body, html {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Kanit', sans-serif;
            background: #0f2027;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ปุ่ม Fullscreen */
        .fullscreen-btn {
            position: fixed;
            top: 25px;
            right: 25px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 15px;
            border-radius: 15px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: 0.3s;
        }

        .fullscreen-btn svg {
            width: 30px;
            height: 30px;
            fill: white;
        }

        /* เนื้อหาหลัก */
        .main-card {
            z-index: 1;
            text-align: center;
            width: 85%;
            max-width: 900px;
            padding: 50px 40px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            box-shadow: 0 40px 100px rgba(0,0,0,0.5);
        }

        .dept-image-container {
            width: 100%;
            max-width: 350px;
            margin: 0 auto 30px auto;
        }

        .dept-image {
            width: 100%;
            height: auto;
            border-radius: 25px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            object-fit: cover;
        }

        h1 {
            font-size: 3.5rem;
            margin: 0;
            font-weight: 600;
            text-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        h2 {
            font-size: 1.8rem;
            color: var(--udru-gold);
            font-weight: 300;
            margin-top: 15px;
            margin-bottom: 50px;
            line-height: 1.4;
        }

        .start-btn {
            background: linear-gradient(45deg, #00c853, #b2ff59);
            color: #004d40;
            border: none;
            padding: 25px 80px;
            font-size: 2.2rem;
            font-weight: 600;
            border-radius: 100px;
            cursor: pointer;
            box-shadow: 0 15px 40px rgba(0, 200, 83, 0.4);
            transition: all 0.2s ease;
        }

        .start-btn:active {
            transform: scale(0.95);
        }

        /* ===== IDLE SCREEN ===== */
        .idle {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle, #1a2a40 0%, #0a192f 100%);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 9999;
            cursor: pointer;
        }

        .idle.active {
            display: flex;
        }

        .robot-img {
            width: 80%;
            max-width: 450px;
            filter: drop-shadow(0 0 20px rgba(0, 229, 255, 0.5));
            animation: float 3s ease-in-out infinite alternate;
        }

        .idle-text {
            margin-top: 30px;
            font-size: 2.5rem;
            color: #00e5ff;
            text-align: center;
            animation: pulse 2s infinite;
        }

        @keyframes float {
            from { transform: translateY(0); }
            to { transform: translateY(-30px); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

    </style>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/idle.css') }}">
</head>
<body>

    <button class="fullscreen-btn" onclick="toggleFullscreen()">
        <svg viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
    </button>

    <div class="main-card">
        <div class="dept-image-container">
            <img src="/static/images/comengi.jpg" alt="Department Image" class="dept-image">
        </div>
        
        <h1>ยินดีต้อนรับ</h1>
        <h2>สาขาวิชาวิศวกรรมคอมพิวเตอร์และการสื่อสาร<br>มหาวิทยาลัยราชภัฏอุดรธานี</h2>

        <button class="start-btn" onclick="goToRooms()">เลือกห้องเรียน</button>
    </div>

    <div id="idle-screen" class="idle" onclick="wakeUp(event)">
    <div class="robot-face-canvas">
        <div class="antenna-l"><div class="antenna-tip" style="left:-7px; top:-15px;"></div></div>
        <div class="antenna-r"><div class="antenna-tip" style="left:-7px; top:-15px;"></div></div>
        
        <div class="circuit-line line-left"></div>
        <div class="circuit-line line-right"></div>

        <div class="eyes-container">
            <div class="robot-eye"><div class="pupil"></div></div>
            <div class="robot-eye"><div class="pupil"></div></div>
        </div>
        
        <div class="robot-mouth"></div>
    </div>
    
    <div style="text-align: center; margin-top: 40px;">
        <p class="idle-text" style="color: #ffcc00; font-size: 1.5rem; margin-bottom: 5px;">UDRU ROBOT</p>
        <p style="color: #00e5ff; font-weight: 300; letter-spacing: 1px;">วิศวกรรมคอมพิวเตอร์และการสื่อสาร</p>
    </div>
    <p class="idle-text">แตะหน้าจอเพื่อเริ่มต้นใช้งาน</p>
</div>

    <script>
        const IDLE_TIME = 10000; // 10 วินาที
        let idleTimer;

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        function goToRooms() {
            window.location.href = "/room"; 
        }

        function showIdle() {
            document.getElementById("idle-screen").classList.add("active");
        }

        function hideIdle() {
            document.getElementById("idle-screen").classList.remove("active");
        }

        function resetIdleTimer() {
            clearTimeout(idleTimer);
            // ถ้านิ่งครบ 10 วินาที ให้แสดงหน้า Idle
            idleTimer = setTimeout(showIdle, IDLE_TIME);
        }

        function wakeUp(event) {
            if (event) event.stopPropagation(); // ป้องกันการกดทะลุไปโดนปุ่มด้านล่าง
            hideIdle();
            resetIdleTimer();
            console.log("Wake up robot");
        }

        // ตรวจจับการใช้งานทุกประเภทเพื่อรีเซ็ตตัวนับเวลา
        ["touchstart", "mousedown", "mousemove", "keypress"].forEach(evt => {
            document.addEventListener(evt, resetIdleTimer, true);
        });

        // ป้องกันการ Swipe เพื่อ Refresh หรือ Zoom บนจอสัมผัส
        document.addEventListener('touchmove', function (e) {
            if (e.scale !== 1) e.preventDefault();
        }, { passive: false });

        // เริ่มต้นตัวนับเวลาเมื่อโหลดหน้าเสร็จ
        resetIdleTimer();
    </script>

</body>
</html>